

# Medical Chatbot – RAG-based AI Application

This project is a **Medical Question Answering Chatbot** built using a **Retrieval-Augmented Generation (RAG)** approach.
It answers user questions based on a **preloaded medical PDF** using embeddings stored in **Pinecone** and responses generated by **OpenAI GPT models**.

The application is containerized using **Docker**, deployed on **AWS EC2**, and automatically deployed using **GitHub Actions CI/CD**.

---

## What this project does

* Loads a **medical book PDF** stored inside the project
* Splits the content into chunks
* Creates embeddings using **OpenAI**
* Stores embeddings in **Pinecone**
* Retrieves relevant content for every user question
* Generates an answer using **GPT-4o**
* Provides a simple **web-based chat interface**
* Automatically deploys updates to AWS using CI/CD

---

## Tech Stack

* Backend: FastAPI
* Frontend: HTML, CSS
* LLM: OpenAI (GPT-4o)
* Embeddings: OpenAI `text-embedding-3-small`
* Vector Database: Pinecone
* RAG Framework: LangChain
* Containerization: Docker
* Cloud: AWS EC2 + ECR
* CI/CD: GitHub Actions (self-hosted runner)

---

## Project Structure

```
medical_chatbot/
├── app.py
├── src/
│   ├── service.py
│   ├── chat.py
│   ├── helper.py
│   └── prompt.py
├── data/
│   └── Medical_book.pdf
├── web/
│   ├── index.html
│   ├── style.css
│   └── bot.png
├── Dockerfile
├── requirements.txt
├── .dockerignore
├── .github/workflows/cicd.yaml
└── README.md
```

---

## 1. Fork and clone the repository

Fork the repository from GitHub, then clone it:

```bash
git clone https://github.com/<your-username>/MedicalChatbot.git
cd MedicalChatbot
```

---

## 2. Create and activate virtual environment (local)

```bash
python -m venv .venv
source .venv/bin/activate   # Linux / Mac
.venv\Scripts\activate      # Windows
```

---

## 3. Install dependencies

```bash
pip install -r requirements.txt
```

---

## 4. Set environment variables

Create a `.env` file in the project root:

```env
OPENAI_API_KEY=your_openai_api_key
PINECONE_API_KEY=your_pinecone_api_key
```

⚠️ Do **not** commit this file.

---

## 5. Run the application locally (without Docker)

```bash
uvicorn app:app --reload
```

Open in browser:

```
http://localhost:8000
```

---

## 6. Build and run using Docker (local test)

### Build Docker image

```bash
docker build -t medical-chatbot .
```

### Run container

```bash
docker run -p 8080:8080 \
  -e OPENAI_API_KEY=your_openai_key \
  -e PINECONE_API_KEY=your_pinecone_key \
  medical-chatbot
```

Open:

```
http://localhost:8080
```

---

## 7. Create AWS resources (one-time)

### a) Create ECR repository

```bash
aws ecr create-repository --repository-name medicalchatbot
```

### b) Create EC2 instance

* Ubuntu 22.04
* Open port **8080** in Security Group
* Attach IAM role with:

  * `AmazonEC2ContainerRegistryReadOnly`

---

## 8. Setup GitHub Actions secrets

In GitHub → Settings → Actions → Secrets:

```
AWS_ACCESS_KEY_ID
AWS_SECRET_ACCESS_KEY
AWS_DEFAULT_REGION
ECR_REPO
OPENAI_API_KEY
PINECONE_API_KEY
```

---

## 9. Setup GitHub self-hosted runner on EC2

SSH into EC2:

```bash
ssh -i medicalbot.pem ubuntu@<EC2_PUBLIC_IP>
```

Download and configure runner (from GitHub UI instructions), then install as service:

```bash
cd actions-runner
sudo ./svc.sh install
sudo ./svc.sh start
sudo ./svc.sh status
```

Runner must show **Idle** in GitHub.

---

## 10. CI/CD Deployment Flow

Every push to `main`:

1. GitHub Actions builds Docker image
2. Image is pushed to AWS ECR
3. Self-hosted runner on EC2 pulls image
4. Old container is stopped
5. New container starts automatically

Deployment happens **without manual intervention**.

---

## 11. Access the live application

```
http://<EC2_PUBLIC_IP>:8080
```


### Stop EC2 container

```bash
docker stop medical-chatbot
```

### View logs

```bash
docker logs medical-chatbot
```

### Check running containers

```bash
docker ps
```

---

## Future Improvements

* HTTPS with Nginx + SSL
* Domain name mapping
* Streaming responses
* Authentication
* Chat history persistence
* Multiple document support

---

## Author

**Yella Reddy**
GitHub: [https://github.com/yellareddy19](https://github.com/yellareddy19)

